# GDD: Air Vehicle Autopilot Mod (Cyberpunk 2077)

## 1. Общая идея
Мод добавляет **автопилот для воздушного транспорта (AV)**, работающий по принципу "авиадорог" (коридоров).  
Игрок сможет вызвать AV, которое пролетит по маршруту в автоматическом режиме, в том числе с посадкой и высадкой.

---

## 2. Цели мода
- Дать игроку ощущение настоящего "летающего такси" в духе киберпанка (например, как в катсценах в некоторых миссиях).
- Реализовать удобную систему перемещения AV по городу.
- Интегрировать механику с существующими системами (автопилот машин, фаст-трэвел, катсцены).

---

## 3. Ключевые фичи
1. **Авиадороги (коридоры)**
    - 2D/3D сетка маршрутов над городом.
    - Узлы соединены рёбрами, образуя граф. (как вариант реализации)
    - Возможность разных высот и типов маршрутов.

2. **Автопилот AV**
    - Входит в ближайший коридор, если игрок далеко.
    - Строит кратчайший путь от точки входа до выхода.
    - Летит по маршруту с учётом высоты.

3. **Посадка/высадка**
    - Система катсцен (анимация камеры при посадке/вылете).
    - Возможность телепорта/скрытой подмены для упрощения.
    - Возможность посадки в любой точке карты / в специальных точках вызова
4. **Интерфейс**
    - Вызов AV через меню (подобно Delamain такси).
    - Выбор точки назначения (списком или на карте).

---

## 4. Игровое взаимодействие (**флоу**)
1. Игрок вызывает AV → выбирает пункт назначения.
2. AV прилетает → запускается катсцена посадки.
3. AV автоматически летит по построенному маршруту.
4. Прибывает к месту назначения → катсцена высадки.
5. Игрок снова в обычном управлении.

---

## 5. Техническая реализация

### 5.1. Граф маршрутов (как один из варинатов, пока что основной)
- Узлы: координаты (X, Y, Z).
- Рёбра: связи между узлами, вес = длина/время.
- Алгоритм поиска пути: **A\*** (с эвристикой "прямое расстояние").
- Хранение: JSON (узлы/связи).

### 5.2. Автопилот
- Базируется на существующем ground autopilot (не факт, мб нейронку сделать для просчета, либо самостоятельно прописать автопилот).
- Добавляется поддержка Z (высоты).
- Скрипт:
    - найти ближайший узел к старту,
    - найти ближайший узел к цели,
    - построить путь,
    - AV следует по узлам.

### 5.3. Катсцены
- Камера переключается на "киношный" режим.
- Анимация посадки/вылета → переход в управление игрока.
- Минимальная версия: просто скрипт камеры + перемещение.
- Продвинутая версия: подключение к реальным анимациям через WolvenKit.

### 5.4. Интерфейс
- Меню вызова (CET UI).
- Возможность выбора из списка точек назначения.
- Будущее: интеграция с картой.

---

## 6. Роадмап разработки
### MVP (минималка)
- JSON с маршрутами.
- A\*-поиск пути.
- AV летит по точкам.
- Телепорт/простая катсцена при посадке.

### Версия 1.0
- Нормальные катсцены.
- UI для вызова AV.
- Несколько типов маршрутов (низкий/высокий).

### Будущее
- Интеграция с заданиями/ивентами.
- Динамическое движение других AV в коридорах.
- Возможность апгрейда AV (быстрее, броня и т.д.).

---

## 7. Риски и ограничения
- Ограничения движка Cyberpunk 2077 (навмеши, катсцены).
- Оптимизация: слишком много AV может грузить систему.
- Сложность интеграции с UI карты.

---

## 8. Инструменты
- **Cyber Engine Tweaks (Lua)** — логика, скрипты.
- **WolvenKit** — работа с анимациями, ресурсами.
- **JSON** — хранение графа маршрутов.
- **C++** — если понадобится нативное расширение.  
